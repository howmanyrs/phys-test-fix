
# Инструкция по использованию скрипта для устранения ошибки в тесте по физике (learn.urfu.ru)

Этот скрипт предназначен для решения проблемы с несохранением результатов теста по физике на платформе `learn.urfu.ru`. Он периодически отправляет специальные сигналы (SCORM `Commit`) системе обучения, чтобы поддерживать сессию активной.

## Шаги по использованию:

1.  **Начните тест:**
    *   Перейдите на сайт `learn.urfu.ru` и запустите тест по физике, с которым у вас возникают проблемы.

2.  **Откройте консоль разработчика:**
    *   Это можно сделать несколькими способами:
        *   Нажмите клавишу `F12` на клавиатуре.
        *   Или нажмите сочетание клавиш `Ctrl+Shift+I` (для Windows/Linux) или `Cmd+Opt+I` (для macOS).
        *   Или кликните правой кнопкой мыши в любом месте страницы и выберите "Просмотреть код", "Исследовать элемент" или "Inspect" (название может немного отличаться в зависимости от браузера).
    *   В открывшемся окне разработчика перейдите на вкладку **"Консоль"** (Console).

3.  **Выберите правильный iframe (ОЧЕНЬ ВАЖНО!):**
    *   Тест по физике, скорее всего, работает внутри специального встроенного "окна", которое называется `iframe`. Скрипт должен быть запущен именно в контексте этого `iframe`.
    *   В верхней части консоли разработчика вы увидите выпадающий список. Изначально там обычно выбрано `top` (или что-то похожее, указывающее на основную страницу).
        ![Пример расположения списка iframe](https://i.imgur.com/J7d2T1W.png)
        *(На скриншоте выше показано, где искать этот список)*
    *   Нажмите на этот выпадающий список (`top`).
    *   Вам нужно найти и выбрать `iframe`, относящийся к тесту. Судя по предоставленному скриншоту, это `iframe` с названием, содержащим **`33833`** и `learn.urfu.ru`.
        *   **В вашем случае номер может быть другим!** Ищите запись, которая выглядит как `[число] learn.urfu.ru` и не является `top` или `DevTools Performance Metrics`. Обычно это третий или четвертый пункт в списке, если считать сверху.
        ![Пример выбора нужного iframe](https://i.imgur.com/J7d2T1W.png)
        *(На скриншоте показан пример, где выбран правильный `iframe` – `33833 learn.urfu.ru`)*
    *   **Убедитесь, что после выбора в строке рядом с выпадающим списком отображается выбранный вами `iframe` (например, `33833 learn.urfu.ru`), а не `top`.** Если там все еще `top`, скрипт не сработает правильно.

4.  **Скопируйте скрипт:**
    *   Перейдите по ссылке к файлу скрипта: [phys-test-fix.js](phys-test-fix.js) (если `README.md` и скрипт в одном репозитории, ссылка будет работать).
        *   *Если вы просматриваете это на GitHub, кликните на `phys-test-fix.js`, затем нажмите кнопку "Raw" (Необработанный), чтобы увидеть чистый код.*
    *   Выделите весь текст скрипта (обычно `Ctrl+A` на Windows/Linux или `Cmd+A` на macOS).
    *   Скопируйте выделенный текст в буфер обмена (`Ctrl+C` на Windows/Linux или `Cmd+C` на macOS).

5.  **Вставьте и запустите скрипт:**
    *   Вернитесь в окно браузера с тестом и открытой консолью разработчика (убедитесь, что выбран правильный `iframe` из шага 3!).
    *   Кликните мышкой в области ввода команд консоли (обычно это строка в самом низу вкладки "Консоль", рядом с символом `>` или `>>`).
    *   Вставьте скопированный скрипт (`Ctrl+V` на Windows/Linux или `Cmd+V` на macOS).
    *   Нажмите клавишу `Enter`.

6.  **Проверка работы:**
    *   После нажатия `Enter` скрипт должен автоматически запуститься.
    *   В консоли вы увидите сообщения, начинающиеся с:
        ```
        SCORM Keep-Alive script initializing...
        ```
        Затем, если API найден:
        ```
        SCORM API found on initial load.
        Attempting to auto-start SCORM keep-alive with default interval (...)
        Starting SCORM keep-alive: Commit("") every X seconds.
        SCORM Keep-Alive attempt #1
        Commit("") result: true
        GetLastError() after commit: 0
        ```
    *   Если вы видите периодически появляющиеся сообщения `SCORM Keep-Alive attempt #...` и `Commit("") result: true`, значит скрипт работает корректно.
    *   Теперь вы можете продолжать проходить тест. Скрипт будет работать в фоновом режиме.

## Как остановить скрипт (если необходимо):

Если вам нужно остановить работу скрипта (например, после завершения теста или если вы хотите попробовать пройти тест без него):

1.  Убедитесь, что в консоли разработчика все еще выбран тот же самый `iframe` (например, `33833 learn.urfu.ru`).
2.  Введите в консоль следующую команду:
    ```javascript
    window.stopScormKeepAlive()
    ```
3.  Нажмите `Enter`.
4.  Вы должны увидеть сообщение `SCORM keep-alive pings stopped.`

## Важные замечания:

*   Эту процедуру (шаги 2-5) необходимо повторять каждый раз, когда вы начинаете новую попытку теста, если проблема с сессией повторяется.
*   **Выбор правильного `iframe` (шаг 3) — это самый важный момент.** Если выбрать не тот `iframe` (например, оставить `top`), скрипт не сможет найти SCORM API теста и не будет работать.
*   Этот скрипт является временным решением (workaround) и не исправляет первопричину проблемы на стороне платформы обучения.
*   Если после вставки скрипта появляются какие-то другие ошибки (не связанные с сообщениями от `SCORM Keep-Alive`), это может указывать на другие проблемы на странице или несовместимость.

Удачи с тестом!
